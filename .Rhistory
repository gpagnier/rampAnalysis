histogram(dBehavioral$percentageGambled,breaks=50,ylim=c(0,70),xlim=c(-5,100),main=paste("Propensity to gamble on low RPEs; n =",toString(sum(dBehavioral$trials)),"trials;",nParticipants,"participants"),xlab="Percentage of time gambled")
length(dlowPE$gambleRT)
length(dlowPE$gambleRT[dlowPE$gambleRT!=0])
533/1484
length(dhighPE$gambleRT)
length(dhighPE$gambleRT[dhighPE$gambleRT!=0])
#High PredictionError only
dhighPE<-filter(dgamble,PredictionError>0)
length(dhighPE$gambleRT)
length(dhighPE$gambleRT[dhighPE$gambleRT!=0])
length(dhighPE$gambleRT[dhighPE$gambleRT!=0])/length(dhighPE$gambleRT[dhighPE$gambleRT!=0])
length(dhighPE$gambleRT[dhighPE$gambleRT!=0])/(length(dhighPE$gambleRT[dhighPE$gambleRT!=0]))
which(dgamble$PredictionError==0)
temp<-filter(dgamble,PredictionError==0)
length(temp$PredictionError)
length(temp$PredictionError[temp$gambleRT!=0])
length(dgamble$gambleDelay)
length(dgamble$gambleDelay[dgamble$gambleRT!=0])
1336/3522
597/1504
718/1137
597/1503
718/1137]
718/1137
#Low PredictionError only
dlowPE<-filter(dgamble,PredictionError<0)
length(dlowPE$gambleRT)
length(dlowPE$gambleRT[dlowPE$gambleRT!=0])
533/1484
length(dhighPE$gambleRT)
length(dhighPE$gambleRT[dhighPE$gambleRT!=0])
histogram(setdiff(dlowPE$gambleRT,0),breaks=50,main="Reaction Time for low RPEs",xlab="Reaction time")
dlowPE2<-dlowPE %>%
group_by(binsTime) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100),
medianRT=round(mean(gambleRT)),
sdRT=sd(gambleRT))
dlowPE2$seconds<-dlowPE2$binsTime
plot(dlowPE2$seconds,dlowPE2$percentageGambled,xlim = c(0,8),ylim = c(0,100),
main=paste("Low RPE; Gamble propensity; n =",toString(sum(dlowPE2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Percentage Gambled",pch=19)
dlowPE2
#Plotting RTs with sd
dlowPERT<-filter(dlowPE,gambleRT!=0) %>%
group_by(binsTime) %>%
summarise(medianRT=mean(gambleRT),
sdRT=sd(gambleRT))
dlowPERT$seconds<-dlowPERT$binsTime
plot(dlowPERT$seconds,dlowPERT$medianRT,xlim = c(0,8),ylim=c(200,2500),main=paste("Low RPE; Reaction time with sd; n =",toString(sum(dhighp2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Reaction time (seconds)",pch=19)
597/1504
d2<-d %>%
group_by(binsTime) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100),
meanRT=mean(gambleRT),
sdRT=sd(gambleRT))
d2$seconds<-d2$binsTime
#Number of trials per bin - this is a check to confirm that bin sizes are reasonable
plot(d2$seconds,d2$trials,xlim = c(-.5,8),
main=paste("Number of trials per bin; n =",toString(sum(d2$trials)),"trials;",nParticipants,"participants"),
xlab="Seconds into trial",ylab="Number of trials",pch=19)
#Overall regression of p(gambled) as gambles interrupted trial
d2<-filter(d2,seconds>0)
plot(d2$seconds,d2$percentageGambled,xlim = c(0,8),ylim = c(0,100),
main=paste("Propensity to gamble vs. gamble interruption; n =",toString(sum(d2$trials)),"trials;",nParticipants,"participants"),
xlab="Seconds into trial",ylab="Percentage Gambled",pch=19)
m1<-lm(d2$percentageGambled~d2$seconds)
abline(m1)
summary(m1)
d2<-filter(d2,seconds>0)
plot(d2$seconds,d2$percentageGambled,xlim = c(0,8),ylim = c(0,100),
main=paste("Propensity to gamble vs. gamble interruption; n =",toString(sum(d2$trials)),"trials;",nParticipants,"participants"),
xlab="Seconds into trial",ylab="Percentage Gambled",pch=19)
unique(dhighp$standardGamble)
dhighp<-filter(dhighp,standardGamble==5|standardGamble==6)
length(dhighp$gambleRT)
length(dhighp$gambleRT[dhighp$gambleRT!=0])
251/376
length(dhighp$gambleRT)
length(dhighp$gambleRT[dhighp$gambleRT!=0])
dBehavioral<-dhighp %>%
group_by(uniqueid) %>%
summarise(experimentTime=unique(expTime)[1],
trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
dBehavioral
histogram(dBehavioral$percentageGambled,breaks=50,ylim=c(0,70),xlim=c(-5,100),main=paste("Propensity to gamble on high payout gambles; n =",toString(sum(dBehavioral$trials)),"trials;",nParticipants,"participants"),xlab="Percentage of time gambled")
histogram(setdiff(dhighp$gambleRT,0),breaks=50,main="Reaction Time for high odds gambles",xlab="Reaction time",xlim=c(0,1000))
histogram(setdiff(dhighp$gambleRT,0),breaks=50,main="Reaction Time for high odds gambles",xlab="Reaction time",xlim=c(0,1000))
histogram(dBehavioral$percentageGambled,breaks=50,ylim=c(0,70),xlim=c(-5,100),main=paste("Propensity to gamble on high payout gambles; n =",toString(sum(dBehavioral$trials)),"trials;",nParticipants,"participants"),xlab="Percentage of time gambled")
dhighp2<-dhighp %>%
group_by(binsTime) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100),
medianRT=round(mean(gambleRT)),
sdRT=sd(gambleRT))
dhighp2$seconds<-dhighp2$binsTime
plot(dhighp2$seconds,dhighp2$percentageGambled,xlim = c(0,8),ylim = c(0,100),
main=paste("High odds; Gamble propensity; n =",toString(sum(dhighp2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Percentage Gambled",pch=19)
dhighp2
#Plotting RTs with sd
dhighRT<-filter(dhighp,gambleRT!=0) %>%
group_by(binsTime) %>%
summarise(medianRT=mean(gambleRT),
sdRT=sd(gambleRT))
dhighRT$seconds<-dhighRT$binsTime
plot(dhighRT$seconds,dhighRT$medianRT,xlim = c(0,8),ylim=c(200,2500),main=paste("High Odds; Reaction time with sd; n =",toString(sum(dhighp2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Reaction time (seconds)",pch=19)
plot(dhighRT$seconds,dhighRT$medianRT,xlim = c(0,8),ylim=c(500,1000),main=paste("High Odds; Reaction time with sd; n =",toString(sum(dhighp2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Reaction time (seconds)",pch=19)
dhighp<-filter(dhighp,PredictionError>0)
length(dhighp$gambleRT)
length(dhighp$gambleRT[dhighp$gambleRT!=0])
dBehavioral<-dhighp %>%
group_by(uniqueid) %>%
summarise(experimentTime=unique(expTime)[1],
trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
dBehavioral
histogram(dBehavioral$percentageGambled,breaks=50,ylim=c(0,70),xlim=c(-5,100),main=paste("Propensity to gamble on high payout gambles; n =",toString(sum(dBehavioral$trials)),"trials;",nParticipants,"participants"),xlab="Percentage of time gambled")
histogram(setdiff(dhighp$gambleRT,0),breaks=50,main="Reaction Time for high odds gambles",xlab="Reaction time",xlim=c(0,1000))
dhighp2<-dhighp %>%
group_by(binsTime) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100),
medianRT=round(mean(gambleRT)),
sdRT=sd(gambleRT))
dhighp2$seconds<-dhighp2$binsTime
plot(dhighp2$seconds,dhighp2$percentageGambled,xlim = c(0,8),ylim = c(0,100),
main=paste("High odds; Gamble propensity; n =",toString(sum(dhighp2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Percentage Gambled",pch=19)
dhighp2
#Plotting RTs with sd
dhighRT<-filter(dhighp,gambleRT!=0) %>%
group_by(binsTime) %>%
summarise(medianRT=mean(gambleRT),
sdRT=sd(gambleRT))
dhighRT$seconds<-dhighRT$binsTime
plot(dhighRT$seconds,dhighRT$medianRT,xlim = c(0,8),ylim=c(500,1000),main=paste("High Odds; Reaction time with sd; n =",toString(sum(dhighp2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Reaction time (seconds)",pch=19)
d2<-d %>%
group_by(binsTime) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100),
meanRT=mean(gambleRT),
sdRT=sd(gambleRT))
d2$seconds<-d2$binsTime
#Number of trials per bin - this is a check to confirm that bin sizes are reasonable
plot(d2$seconds,d2$trials,xlim = c(-.5,8),
main=paste("Number of trials per bin; n =",toString(sum(d2$trials)),"trials;",nParticipants,"participants"),
xlab="Seconds into trial",ylab="Number of trials",pch=19)
#Overall regression of p(gambled) as gambles interrupted trial
d2<-filter(d2,seconds>0)
plot(d2$seconds,d2$percentageGambled,xlim = c(0,8),ylim = c(0,100),
main=paste("Propensity to gamble vs. gamble interruption; n =",toString(sum(d2$trials)),"trials;",nParticipants,"participants"),
xlab="Seconds into trial",ylab="Percentage Gambled",pch=19)
plot(d2$seconds,d2$percentageGambled,xlim = c(0,8),ylim = c(20,60),
main=paste("Propensity to gamble vs. gamble interruption; n =",toString(sum(d2$trials)),"trials;",nParticipants,"participants"),
xlab="Seconds into trial",ylab="Percentage Gambled",pch=19)
subj<-unique(d$uniqueid)
intN<-NULL
botN<-NULL
for(i in Participants){
print(i)
dsub<-d[d$uniqueid==i,]
d4<-dsub %>%
group_by(binsTime) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
d4$seconds<-d4$binsTime
d4<-filter(d4,seconds>0)
# plot(d4$seconds,d4$percentageGambled,xlim = c(0,7),ylim = c(0,100),
#      main=paste("Individual participant data; n =",toString(sum(d4$trials)),"trials;","participant:",toString(unique(dsub$uniqueid))),
#      xlab="Seconds into trial",ylab="Percentage Gambled",pch=19)
mtemp<-lm(d4$percentageGambled~d4$seconds)
if (sum(dsub$outcomeRT)>0){
hist(setdiff(dsub$outcomeRT,0),breaks=50,xlim=c(0,800),main=c("Outcome RT; participant: ",i,"meanOutcomeRT: ",round(mean(setdiff(dsub$outcomeRT,0)))/1000))}
#This checks to see if any participant is ramping
if(summary(mtemp)$coefficients[8]<.05 & summary(mtemp)$coefficients[2]>0){
intN<-c(intN,i)
}
#Check to see if any participant has a RT that's susupiciously low..
if(mean(setdiff(dsub$outcomeRT,0),na.rm=TRUE)<250){
botN<-c(botN,i)
}
}
subj<-unique(d$uniqueid)
intN<-NULL
botN<-NULL
for(i in Participants){
dsub<-d[d$uniqueid==i,]
d4<-dsub %>%
group_by(binsTime) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
d4$seconds<-d4$binsTime
d4<-filter(d4,seconds>0)
plot(d4$seconds,d4$percentageGambled,xlim = c(0,7),ylim = c(0,100),
main=paste("Individual participant data; n =",toString(sum(d4$trials)),"trials;","participant:",toString(unique(dsub$uniqueid))),
#     xlab="Seconds into trial",ylab="Percentage Gambled",pch=19)
mtemp<-lm(d4$percentageGambled~d4$seconds)
# if (sum(dsub$outcomeRT)>0){
#   hist(setdiff(dsub$outcomeRT,0),breaks=50,xlim=c(0,800),main=c("Outcome RT; participant: ",i,"meanOutcomeRT: ",round(mean(setdiff(dsub$outcomeRT,0)))/1000))}
#
#This checks to see if any participant is ramping
if(summary(mtemp)$coefficients[8]<.05 & summary(mtemp)$coefficients[2]>0){
intN<-c(intN,i)
}
#Check to see if any participant has a RT that's susupiciously low..
if(mean(setdiff(dsub$outcomeRT,0),na.rm=TRUE)<250){
botN<-c(botN,i)
}
}
#Printing off Reaction time histograms by bin
#a<-filter(dgamble,binsTime<5.75)
#for(i in sort(unique(dgamble$binsTime))){
#  atemp<-filter(a,binsTime==i&gambleRT!=0)
#  print(head(atemp))
#  print(histogram(atemp$gambleRT,breaks=50,main=paste("RT by interruption, Gamble interrupted around ~ ",toString(i)," seconds")))#,"Number of trials:",toString(length(atemp$gambleRT)))))
#  print(i)
#}
#Looking into participants that ramp
for(i in intN){
}
###Breaking down cond. individual participant (p)
p<-286
dp=filter(d,uniqueid==p)
dsubMagCond<-filter(d,uniqueid==p&magCond!="catch") %>%
group_by(magCond) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
barplot(dsubMagCond$percentageGambled,names.arg=dsubMagCond$magCond,beside=T,ylab="Number of trials",main=c("Participant ",p, " propensity to gamble across magnitude"))
dsubOddsCond<-filter(d,uniqueid==p&oddsCond!="catch") %>%
group_by(oddsCond) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
barplot(dsubOddsCond$percentageGambled,names.arg=dsubOddsCond$oddsCond,beside=T,ylab="Number of trials",main=c("Participant ",p, " propensity to gamble across odds"))
pDF=(filter(d,uniqueid==p&magCond!="catch"))
histogram(setdiff(pDF$outcomeRT,0),breaks=50,xlim=c(0,800))
subj<-unique(d$uniqueid)
intN<-NULL
botN<-NULL
for(i in Participants){
print(i)
dsub<-d[d$uniqueid==i,]
d4<-dsub %>%
group_by(binsTime) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
d4$seconds<-d4$binsTime
d4<-filter(d4,seconds>0)
plot(d4$seconds,d4$percentageGambled,xlim = c(0,7),ylim = c(0,100),
main=paste("Individual participant data; n =",toString(sum(d4$trials)),"trials;","participant:",toString(unique(dsub$uniqueid))),
xlab="Seconds into trial",ylab="Percentage Gambled",pch=19)
mtemp<-lm(d4$percentageGambled~d4$seconds)
# if (sum(dsub$outcomeRT)>0){
#   hist(setdiff(dsub$outcomeRT,0),breaks=50,xlim=c(0,800),main=c("Outcome RT; participant: ",i,"meanOutcomeRT: ",round(mean(setdiff(dsub$outcomeRT,0)))/1000))}
#
#This checks to see if any participant is ramping
if(summary(mtemp)$coefficients[8]<.05 & summary(mtemp)$coefficients[2]>0){
intN<-c(intN,i)
}
#Check to see if any participant has a RT that's susupiciously low..
if(mean(setdiff(dsub$outcomeRT,0),na.rm=TRUE)<250){
botN<-c(botN,i)
}
}
###Breaking down cond. individual participant (p)
p<-286
dp=filter(d,uniqueid==p)
dsubMagCond<-filter(d,uniqueid==p&magCond!="catch") %>%
group_by(magCond) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
barplot(dsubMagCond$percentageGambled,names.arg=dsubMagCond$magCond,beside=T,ylab="Number of trials",main=c("Participant ",p, " propensity to gamble across magnitude"))
dsubOddsCond<-filter(d,uniqueid==p&oddsCond!="catch") %>%
group_by(oddsCond) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
barplot(dsubOddsCond$percentageGambled,names.arg=dsubOddsCond$oddsCond,beside=T,ylab="Number of trials",main=c("Participant ",p, " propensity to gamble across odds"))
pDF=(filter(d,uniqueid==p&magCond!="catch"))
histogram(setdiff(pDF$outcomeRT,0),breaks=50,xlim=c(0,800))
dsubMagCond
dBehavioral<-dp %>%
group_by(uniqueid) %>%
summarise(experimentTime=unique(expTime)[1],
trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
dBehavioral
dsubOddsCond<-filter(d,uniqueid==p&oddsCond!="catch") %>%
group_by(oddsCond) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
barplot(dsubOddsCond$percentageGambled,names.arg=dsubOddsCond$oddsCond,beside=T,ylab="Number of trials",main=c("Participant ",p, " propensity to gamble across odds"))
dsubOddsCond
dBehavioral<-dp %>%
group_by(uniqueid) %>%
summarise(experimentTime=unique(expTime)[1],
trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
dBehavioral<-dp %>%
group_by(uniqueid) %>%
summarise(experimentTime=unique(expTime)[1],
trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
dBehavioral
dsubMagCond<-filter(d,uniqueid==p&magCond!="catch") %>%
group_by(magCond) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
barplot(dsubMagCond$percentageGambled,names.arg=dsubMagCond$magCond,beside=T,ylab="Number of trials",main=c("Participant ",p, " propensity to gamble across magnitude"))
dsubMagCond
###Breaking down cond. individual participant (p)
p<-286
dp=filter(d,uniqueid==p)
dBehavioral<-dp %>%
group_by(uniqueid) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
dBehavioral
dsubMagCond<-filter(d,uniqueid==p&magCond!="catch") %>%
group_by(magCond) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
barplot(dsubMagCond$percentageGambled,names.arg=dsubMagCond$magCond,beside=T,ylab="Number of trials",main=c("Participant ",p, " propensity to gamble across magnitude"))
dsubMagCond
dsubOddsCond<-filter(d,uniqueid==p&oddsCond!="catch") %>%
group_by(oddsCond) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
dsubOddsCond
dBehavioral
dsubMagCond
dsubOddsCond
###Breaking down cond. individual participant (p)
p<-278
dp=filter(d,uniqueid==p)
dBehavioral<-dp %>%
group_by(uniqueid) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
dBehavioral
dsubMagCond<-filter(d,uniqueid==p&magCond!="catch") %>%
group_by(magCond) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
barplot(dsubMagCond$percentageGambled,names.arg=dsubMagCond$magCond,beside=T,ylab="Number of trials",main=c("Participant ",p, " propensity to gamble across magnitude"))
dsubMagCond
dsubOddsCond<-filter(d,uniqueid==p&oddsCond!="catch") %>%
group_by(oddsCond) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
barplot(dsubOddsCond$percentageGambled,names.arg=dsubOddsCond$oddsCond,beside=T,ylab="Number of trials",main=c("Participant ",p, " propensity to gamble across odds"))
dBehavioral
dsubMagCond
dsubOddsCond
###Breaking down cond. individual participant (p)
p<-240
dp=filter(d,uniqueid==p)
dBehavioral<-dp %>%
group_by(uniqueid) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
dsubMagCond<-filter(d,uniqueid==p&magCond!="catch") %>%
group_by(magCond) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
dBehavioral
barplot(dsubMagCond$percentageGambled,names.arg=dsubMagCond$magCond,beside=T,ylab="Number of trials",main=c("Participant ",p, " propensity to gamble across magnitude"))
dsubMagCond
dsubOddsCond<-filter(d,uniqueid==p&oddsCond!="catch") %>%
group_by(oddsCond) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
barplot(dsubOddsCond$percentageGambled,names.arg=dsubOddsCond$oddsCond,beside=T,ylab="Number of trials",main=c("Participant ",p, " propensity to gamble across odds"))
dBehavioral
dsubMagCond
dsubOddsCond
#Overall preference for gambling
histogram(dBehavioralTotal$percentageGambled,breaks=50,xlim=c(-5,100),ylim=c(0,25),main=paste("Overall participant propensity to gamble; n =",toString(sum(dBehavioralTotal$trials)),"trials;",nParticipants,"participants"),xlab="Percentage of time gambled")
plot(dmidRT$seconds,dmidRT$medianRT,xlim = c(0,8),ylim=c(0,2500),main=paste("Mid Odds; median RT with sd; n =",toString(sum(dmidp2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Reaction time (seconds)",pch=19)
plot(dlowRT$seconds,dlowRT$medianRT,xlim = c(0,8),ylim=c(500,1000),main=paste("Low mag; median RT with sd; n =",toString(sum(dlow2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Reaction time (seconds)",pch=19)
# High payout
dhighp<-filter(dgamble,Trialid==31|Trialid==32|Trialid==33|Trialid==34|Trialid==35|Trialid==36)
length(dhighp$gambleRT)
length(dhighp$gambleRT[dhighp$gambleRT!=0])
dBehavioral<-dhighp %>%
group_by(uniqueid) %>%
summarise(experimentTime=unique(expTime)[1],
trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100))
dBehavioral
histogram(dBehavioral$percentageGambled,breaks=50,ylim=c(0,70),xlim=c(-5,100),main=paste("Propensity to gamble on high payout gambles; n =",toString(sum(dBehavioral$trials)),"trials;",nParticipants,"participants"),xlab="Percentage of time gambled")
histogram(setdiff(dhighp$gambleRT,0),breaks=50,main="Reaction Time for high odds gambles",xlab="Reaction time",xlim=c(0,1000))
dhighp2<-dhighp %>%
group_by(binsTime) %>%
summarise(trials=length(trialNumber),
gambleCount=sum(response=="gamble"),
didNotGamble=sum(response=="fail"|response=="success"),
percentageGambled=round(gambleCount/trials*100),
medianRT=round(mean(gambleRT)),
sdRT=sd(gambleRT))
dhighp2$seconds<-dhighp2$binsTime
plot(dhighp2$seconds,dhighp2$percentageGambled,xlim = c(0,8),ylim = c(0,100),
main=paste("High odds; Gamble propensity; n =",toString(sum(dhighp2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Percentage Gambled",pch=19)
dhighp2
#Plotting RTs with sd
dhighRT<-filter(dhighp,gambleRT!=0) %>%
group_by(binsTime) %>%
summarise(medianRT=mean(gambleRT),
sdRT=sd(gambleRT))
dhighRT$seconds<-dhighRT$binsTime
plot(dhighRT$seconds,dhighRT$medianRT,xlim = c(0,8),ylim=c(200,2500),main=paste("High Odds; Reaction time with sd; n =",toString(sum(dhighp2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Reaction time (seconds)",pch=19)
plot(dhighRT$seconds,dhighRT$medianRT,xlim = c(0,8),ylim=c(200,800),main=paste("High Odds; Reaction time with sd; n =",toString(sum(dhighp2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Reaction time (seconds)",pch=19)
#High PredictionError only
dhighPE<-filter(dgamble,PredictionError>0)
plot(dhighRT$seconds,dhighRT$medianRT,xlim = c(0,8),ylim=c(200,100),main=paste("High Odds; Reaction time with sd; n =",toString(sum(dhighp2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Reaction time (seconds)",pch=19)
#High PredictionError only
dhighPE<-filter(dgamble,PredictionError>0)
plot(dhighRT$seconds,dhighRT$medianRT,xlim = c(0,8),ylim=c(200,100),main=paste("High Odds; Reaction time with sd; n =",toString(sum(dhighp2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Reaction time (seconds)",pch=19)
plot(dhighRT$seconds,dhighRT$medianRT,xlim = c(0,8),ylim=c(200,1000),main=paste("High Odds; Reaction time with sd; n =",toString(sum(dhighp2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Reaction time (seconds)",pch=19)
plot(dhighRT$seconds,dhighRT$medianRT,xlim = c(0,8),ylim=c(500,1000),main=paste("High Odds; Reaction time with sd; n =",toString(sum(dhighp2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Reaction time (seconds)",pch=19)
plot(dmidRT$seconds,dmidRT$medianRT,xlim = c(0,8),ylim=c(500,1000),main=paste("Mid Odds; median RT with sd; n =",toString(sum(dmidp2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Reaction time (seconds)",pch=19)
plot(dhighRT$seconds,dhighRT$medianRT,xlim = c(0,8),ylim=c(500,1000),main=paste("High Odds; Reaction time with sd; n =",toString(sum(dhighp2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Reaction time (seconds)",pch=19)
plot(dhighPERT$seconds,dhighPERT$medianRT,xlim = c(0,8),ylim=c(500,1000),main=paste("High RPE; Reaction time with sd; n =",toString(sum(dhighp2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Reaction time (seconds)",pch=19)
plot(dlowPERT$seconds,dlowPERT$medianRT,xlim = c(0,8),ylim=c(500,1000),main=paste("Low RPE; Reaction time with sd; n =",toString(sum(dhighp2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Reaction time (seconds)",pch=19)
plot(dlowRT$seconds,dlowRT$medianRT,xlim = c(0,8),ylim=c(500,1000),main=paste("Low Odds; median RT with sd; n =",toString(sum(dlowp2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Reaction time (seconds)",pch=19)
plot(dlowRT$seconds,dlowRT$medianRT,xlim = c(0,8),ylim=c(500,800),main=paste("Low mag; median RT with sd; n =",toString(sum(dlow2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Reaction time (seconds)",pch=19)
plot(dlowRT$seconds,dlowRT$medianRT,xlim = c(0,8),ylim=c(500,1000),main=paste("Low mag; median RT with sd; n =",toString(sum(dlow2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Reaction time (seconds)",pch=19)
plot(dmidRT$seconds,dmidRT$medianRT,xlim = c(0,8),ylim=c(500,1000),main=paste("Mid mag; median RT with sd; n =",toString(sum(dmid2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Reaction time (seconds)",pch=19)
plot(dhighRT$seconds,dhighRT$medianRT,xlim = c(0,8),ylim=c(500,1000),main=paste("High mag; median RT with sd; n =",toString(sum(dhigh2$trials)),"trials;"),
xlab="Seconds into trial",ylab="Reaction time (seconds)",pch=19)
# Low payout
dlowp<-filter(dgamble,Trialid==21|Trialid==22|Trialid==23|Trialid==24|Trialid==25|Trialid==26)
